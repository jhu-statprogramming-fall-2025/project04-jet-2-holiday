# BIostat 777 Final Group Project  
**Team Name: Jet 2 Holiday**

This repository contains the data cleaning and analytic pipeline used for the
BIostat 777 final group project on FAERS-based safety analysis for type 2 diabetes
mellitus (T2DM) drugs.

Due to data size constraints, cleaned databases and large intermediate files are
not included in this repository. All processing steps are fully reproducible using
the provided scripts.

---

## Team Members
- Jiayi Chu  
- Yixin Xue  
- Shuya Guo  
- Runjiu Chen  

---

## Personal Repository (Full Project Code)

The complete project repository, including the full data cleaning pipeline and
all Shiny dashboard code, is maintained in a separate personal GitHub repository.

### Personal GitHub Repository
https://github.com/Yixin-Xue/biostat777-Final-Project.git

This repository contains:
- The full FAERS data pipeline
- Shiny dashboard source code
- Deployment-related files and configuration
- Essential shared data artifacts for grading (`shared_data/`)

---

## Live Shiny Dashboard

The deployed Shiny dashboard for interactive exploration of the results is
available at:

http://4.155.111.178:3838

> **IMPORTANT NOTICE (PLEASE READ)**  
> **Due to the large size of the cleaned FAERS database (exceeding 25GB) and the
> fact that the dashboard queries the database in real time, the initial page
> load may be slow.**  
>  
> **The deployment is functioning correctly. After opening the dashboard link,
> please wait patiently and do NOT refresh the page.**  
>  
> **Expected loading time is approximately 2 minutes. Refreshing the page during
> this period may interrupt the loading process.**

The dashboard connects to the cleaned FAERS SQLite database generated by the data
pipeline and provides interactive views of global trends, drug profiles,
mechanism comparisons, and temporal safety signals.

---

## Data Availability & Local Setup

**Database Availability & Access**
- The cleaned FAERS SQLite database is substantially large and is therefore not
  stored directly in the GitHub repository to avoid performance and stability
  issues.
- Instead, the database is hosted on Google Drive and can be accessed via:
  https://drive.google.com/file/d/1At-ARdrPf8VsUB_02KgnnJ7bYRZ-mXGN/view?usp=drive_link
- We have contacted the course instructor (Stephanie Hicks) and received explicit
  confirmation that this data-sharing approach is acceptable and will not result
  in any point deduction.

**Local Setup for Grading and Reproducibility**
- Create a folder named `shared_data/` at the project root and place the
  downloaded files there.
- The `shared_data/` folder should contain exactly three files:
  - `faers.sqlite`: fully cleaned, analysis-ready FAERS SQLite database used by
    all scripts and the Shiny dashboard.
  - `temporal_cache.rds`: precomputed temporal summaries to avoid rerunning
    computationally expensive time-series aggregations.
  - `pseudo_soc_map_top.csv`: curated mapping from MedDRA Preferred Terms (PTs)
    to pseudo System Organ Class (SOC) categories, used in
    `step8-pseudo-soc.R` and throughout the dashboard.

---

## Data Pipeline (`scripts/`)

The `scripts/` directory contains the complete FAERS data processing pipeline.
Each script corresponds to a specific step in the workflow:

- `download_faers.R`  
  Download and unzip raw FAERS quarterly data files.

- `step1-clean-names.R`  
  Standardize variable and column names across FAERS tables.

- `step2-clean-content.R`  
  Clean field contents, including IDs, dates, and numeric variables.

- `step3-dedup-sqlite.R`  
  Import cleaned data into SQLite and remove duplicate reports.

- `step4-clean-sql.R`  
  Filter outliers and invalid values; generate cleaned SQL tables.

- `step5-widescreen-sql.R`  
  Create wide-format drug tables and identify target drug exposure cases.

- `step6-normalize-rxnorm.R`  
  Normalize drug names using RxNorm and update exposure records.

- `step7-fine-filter.R`  
  Apply fine-grained filtering to target drug exposure records.

- `step8-pseudo-soc.R`  
  Map reaction preferred terms (PTs) to a custom pseudo System Organ Class (SOC).

- `step9-cohort.R`  
  Assemble cohort-level tables, including demographics, drugs, reactions,
  and outcomes.

- `step10-mechanism.R`  
  Add ATC codes and drug mechanism annotations.

- `step11-analytic.R`  
  Construct the final analytic cohort and derive outcome indicators.

- `check-cohort.R`  
  Perform basic quality assurance checks on the constructed cohort.

Scripts are intended to be run sequentially to reproduce the cleaned analytic
dataset. Large outputs such as SQLite databases are intentionally excluded from
version control.

---

## Notes on Reproducibility
- All data processing logic is contained in the `scripts/` directory of this
  GitHub Classroom repository.
- Large data files are excluded due to size limitations but can be regenerated
  by running the pipeline scripts in order.
- Shiny application code and deployment are maintained separately, following
  course submission instructions.
